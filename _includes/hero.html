{%- assign key = page.hero_key | default: include.key -%}
{%- assign page_images = page.hero_images -%}
{%- assign data_set = site.data.heroes[key] -%}
{%- assign images = page_images | default: data_set.images -%}
{%- assign overlay = page.hero_overlay | default: data_set.overlay | default: 'dark' -%}
{%- assign ctas = page.hero_cta | default: data_set.cta -%}

{%- if images and images.size > 0 -%}
  {%- comment -%}
    Generate a "random" index from site build time and page path.
    This ensures a different image may be chosen on refresh or per page,
    but remains stable during a single render.
  {%- endcomment -%}
  {%- assign seed = site.time | date: "%s" | plus: page.url | size -%}
  {%- assign random_index = seed | modulo: images.size -%}
  {%- assign chosen = images[random_index] -%}
{%- else -%}
  {%- assign chosen = "/img/pooh/pooh-hero.webp" -%} <!-- fallback -->
{%- endif -%}

<section class="hero" role="banner" aria-label="{{ include.title | default: page.title | default: site.title }}">
  <div class="hero-slide is-active" style="background-image:url('{{ chosen | relative_url }}')"></div>

  <div class="hero-overlay hero-overlay--{{ overlay }}"></div>

  <div class="container hero-content">
    <h1>{{ include.title | default: page.title | default: site.title }}</h1>
    {%- if include.subtitle or page.description -%}
      <p class="lead">{{ include.subtitle | default: page.description }}</p>
    {%- endif -%}
    {%- if ctas and ctas.size > 0 -%}
    <div class="hero-ctas">
      {%- for c in ctas -%}
        {%- assign variant = c.variant | default: 'accent' -%}
        <a class="btn btn--{{ variant }}" href="{{ c.href | relative_url }}">{{ c.label }}</a>
      {%- endfor -%}
    </div>
    {%- endif -%}
  </div>
</section>
